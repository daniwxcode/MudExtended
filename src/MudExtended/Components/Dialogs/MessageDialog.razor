@using MudBlazor
@using MudExtended.Enums

<MudDialog>
<TitleContent>
    <MudText Typo="Typo.h6">@Title</MudText>
</TitleContent>
<DialogContent>
        <div class="d-flex gap-4 pa-4">
            @if (ShowIcon)
            {
                <MudIcon Icon="@IconValue" Color="@IconColor" Size="Size.Large" />
            }
            <div class="d-flex flex-column justify-center">
                @if (MessageContent is not null)
                {
                    @MessageContent
                }
                else if (!string.IsNullOrWhiteSpace(Message))
                {
                    <MudText Typo="Typo.body1">@Message</MudText>
                }
                
                @if (!string.IsNullOrWhiteSpace(SecondaryMessage))
                {
                    <MudText Typo="Typo.body2" Color="Color.Secondary" Class="mt-2">
                        @SecondaryMessage
                    </MudText>
                }
            </div>
        </div>
    </DialogContent>
    <DialogActions>
        @if (ShowCancelButton)
        {
            <MudButton OnClick="Cancel" Variant="Variant.Text">@CancelText</MudButton>
        }
        <MudButton OnClick="Close" Variant="Variant.Filled" Color="@ButtonColor">
            @OkText
        </MudButton>
    </DialogActions>
</MudDialog>

@code {
/// <summary>
/// MudBlazor dialog instance.
/// </summary>
[CascadingParameter]
private IMudDialogInstance MudDialog { get; set; } = default!;

    /// <summary>
    /// Dialog title.
    /// </summary>
    [Parameter]
    public string Title { get; set; } = "Message";

    /// <summary>
    /// Main message.
    /// </summary>
    [Parameter]
    public string? Message { get; set; }

    /// <summary>
    /// Secondary message (details).
    /// </summary>
    [Parameter]
    public string? SecondaryMessage { get; set; }

    /// <summary>
    /// HTML message content.
    /// </summary>
    [Parameter]
    public RenderFragment? MessageContent { get; set; }

    /// <summary>
    /// Message severity.
    /// </summary>
    [Parameter]
    public MessageSeverity Severity { get; set; } = MessageSeverity.Info;

    /// <summary>
    /// OK button text.
    /// </summary>
    [Parameter]
    public string OkText { get; set; } = "OK";

    /// <summary>
    /// Cancel button text.
    /// </summary>
    [Parameter]
    public string CancelText { get; set; } = "Cancel";

    /// <summary>
    /// Show icon.
    /// </summary>
    [Parameter]
    public bool ShowIcon { get; set; } = true;

    /// <summary>
    /// Show cancel button.
    /// </summary>
    [Parameter]
    public bool ShowCancelButton { get; set; }

    /// <summary>
    /// Custom icon (auto-determined if null).
    /// </summary>
    [Parameter]
    public string? Icon { get; set; }

    private string IconValue => Icon ?? Severity switch
    {
        MessageSeverity.Info => Icons.Material.Filled.Info,
        MessageSeverity.Success => Icons.Material.Filled.CheckCircle,
        MessageSeverity.Warning => Icons.Material.Filled.Warning,
        MessageSeverity.Error => Icons.Material.Filled.Error,
        _ => Icons.Material.Filled.Info
    };

    private Color IconColor => Severity switch
    {
        MessageSeverity.Info => Color.Info,
        MessageSeverity.Success => Color.Success,
        MessageSeverity.Warning => Color.Warning,
        MessageSeverity.Error => Color.Error,
        _ => Color.Info
    };

    private Color ButtonColor => Severity switch
    {
        MessageSeverity.Info => Color.Primary,
        MessageSeverity.Success => Color.Success,
        MessageSeverity.Warning => Color.Warning,
        MessageSeverity.Error => Color.Error,
        _ => Color.Primary
    };

    private void Close() => MudDialog.Close(DialogResult.Ok(true));

    private void Cancel() => MudDialog.Cancel();
}
